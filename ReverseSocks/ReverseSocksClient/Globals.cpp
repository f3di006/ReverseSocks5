#include"Globals.h"
using namespace std;
char NewConnexion = 0x55;
char ConnexionData = 0x70;
unsigned char bnr[4838] = {
	0x5C, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x20, 0x5C, 0x20,
	0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x5F, 0x5F, 0x20,
	0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20,
	0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x5F, 0x5F, 0x5F, 0x5F,
	0x20, 0x20, 0x2F, 0x20, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x2F,
	0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F,
	0x20, 0x7C, 0x20, 0x20, 0x7C, 0x20, 0x5F, 0x5F, 0x20, 0x20, 0x5F, 0x5F,
	0x5F, 0x5F, 0x5F, 0x5F, 0x0D, 0x0A, 0x20, 0x7C, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x5F, 0x2F, 0x2F, 0x20, 0x5F, 0x5F, 0x20, 0x5C, 0x20,
	0x20, 0x5C, 0x2F, 0x20, 0x2F, 0x2F, 0x20, 0x5F, 0x5F, 0x20, 0x5C, 0x5F,
	0x20, 0x20, 0x5F, 0x5F, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x5F, 0x5F, 0x5F,
	0x2F, 0x2F, 0x20, 0x5F, 0x5F, 0x20, 0x5C, 0x20, 0x5C, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x20, 0x20, 0x5C, 0x20, 0x2F, 0x20, 0x20, 0x5F, 0x20, 0x5C,
	0x5F, 0x2F, 0x20, 0x5F, 0x5F, 0x5F, 0x5C, 0x7C, 0x20, 0x20, 0x7C, 0x2F,
	0x20, 0x2F, 0x20, 0x2F, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x2F, 0x0D, 0x0A,
	0x20, 0x7C, 0x20, 0x20, 0x20, 0x20, 0x7C, 0x20, 0x20, 0x20, 0x5C, 0x20,
	0x20, 0x5F, 0x5F, 0x5F, 0x2F, 0x5C, 0x20, 0x20, 0x20, 0x2F, 0x5C, 0x20,
	0x20, 0x5F, 0x5F, 0x5F, 0x2F, 0x7C, 0x20, 0x20, 0x7C, 0x20, 0x5C, 0x2F,
	0x5C, 0x5F, 0x5F, 0x5F, 0x20, 0x5C, 0x5C, 0x20, 0x20, 0x5F, 0x5F, 0x5F,
	0x2F, 0x20, 0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x28,
	0x20, 0x20, 0x3C, 0x5F, 0x3E, 0x20, 0x29, 0x20, 0x20, 0x5C, 0x5F, 0x5F,
	0x5F, 0x7C, 0x20, 0x20, 0x20, 0x20, 0x3C, 0x20, 0x20, 0x5C, 0x5F, 0x5F,
	0x5F, 0x20, 0x5C, 0x20, 0x0D, 0x0A, 0x20, 0x7C, 0x5F, 0x5F, 0x5F, 0x5F,
	0x7C, 0x5F, 0x20, 0x20, 0x2F, 0x5C, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x3E,
	0x5C, 0x5F, 0x2F, 0x20, 0x20, 0x5C, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x3E,
	0x5F, 0x5F, 0x7C, 0x20, 0x20, 0x2F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20,
	0x3E, 0x5C, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x3E, 0x5F, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x2F, 0x5C, 0x5F, 0x5F, 0x5F, 0x5F, 0x2F,
	0x20, 0x5C, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x3E, 0x5F, 0x5F, 0x7C, 0x5F,
	0x20, 0x5C, 0x2F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x3E, 0x0D, 0x0A,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C,
	0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C,
	0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x5C, 0x2F, 0x20, 0x0D, 0x0A, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x2E, 0x5F, 0x5F, 0x5F, 0x2E, 0x5F, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x20, 0x20, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F,
	0x5F, 0x5F, 0x0D, 0x0A, 0x5F, 0x2F, 0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5C,
	0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x5C, 0x20, 0x20, 0x20, 0x5F,
	0x5F, 0x7C, 0x20, 0x5F, 0x2F, 0x7C, 0x5F, 0x5F, 0x5C, 0x20, 0x20, 0x20,
	0x5F, 0x20, 0x20, 0x5C, 0x20, 0x5C, 0x20, 0x20, 0x20, 0x5F, 0x20, 0x20,
	0x5C, 0x20, 0x20, 0x2F, 0x20, 0x20, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x2F,
	0x0D, 0x0A, 0x5C, 0x20, 0x20, 0x20, 0x5F, 0x5F, 0x5C, 0x20, 0x20, 0x5F,
	0x28, 0x5F, 0x5F, 0x20, 0x20, 0x3C, 0x20, 0x20, 0x2F, 0x20, 0x5F, 0x5F,
	0x20, 0x7C, 0x20, 0x7C, 0x20, 0x20, 0x2F, 0x20, 0x20, 0x2F, 0x5F, 0x5C,
	0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x2F, 0x5F, 0x5C, 0x20, 0x20, 0x5C,
	0x2F, 0x20, 0x20, 0x20, 0x5F, 0x5F, 0x20, 0x20, 0x5C, 0x20, 0x0D, 0x0A,
	0x20, 0x7C, 0x20, 0x20, 0x7C, 0x20, 0x20, 0x20, 0x2F, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x2F, 0x5F, 0x2F, 0x20, 0x7C,
	0x20, 0x7C, 0x20, 0x20, 0x5C, 0x20, 0x20, 0x5C, 0x5F, 0x2F, 0x20, 0x20,
	0x20, 0x5C, 0x20, 0x20, 0x5C, 0x5F, 0x2F, 0x20, 0x20, 0x20, 0x5C, 0x20,
	0x20, 0x7C, 0x5F, 0x5F, 0x5C, 0x20, 0x20, 0x5C, 0x0D, 0x0A, 0x20, 0x7C,
	0x5F, 0x5F, 0x7C, 0x20, 0x20, 0x2F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F,
	0x20, 0x20, 0x2F, 0x5C, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x7C, 0x20, 0x7C,
	0x5F, 0x5F, 0x7C, 0x5C, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x2F,
	0x5C, 0x5F, 0x5F, 0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x2F, 0x5C, 0x5F, 0x5F,
	0x5F, 0x5F, 0x5F, 0x20, 0x20, 0x2F, 0x0D, 0x0A, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x5C, 0x2F, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x20, 0x5C, 0x2F, 0x20,0x00
};

char* granted = (char*)"\x05\x00\x00\x01\x00\x00\x00\x00\x00\x00";
std::vector<std::future<void>> fu;

SOCKET s;
mutex m; // for main socket
mutex mc;//for list
list<socket_details*> clients;